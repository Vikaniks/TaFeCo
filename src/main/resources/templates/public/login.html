<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaFe - Co</title>
    <link rel="icon" th:href="@{/img/Pollo.svg}" />
    <link rel="stylesheet" th:href="@{/css/styles_2.css}" />
    <link rel="stylesheet" th:href="@{/font-awesome-4.7.0/css/font-awesome.min.css}" />
</head>

<body>
<div th:replace="include/header :: header"></div>
<div th:replace="include/nav :: nav"></div>

<main layout:fragment="content">

        <div class="container-row">
            <!-- Левая вертикальная часть -->
            <div class="container-row2">
                <h3>Профиль</h3>
                <p>Пользователь: <strong></strong></p>
                <p>Логин: <strong></strong></p>
                <p>Телефон: <strong></strong></p>
                <p>Адрес: <strong></strong></p>
                
                <h4>Сменить данные или пароль</h4>
            <form id="change-password-form">
                <div class="form-group-row">
                    <input type="tel" placeholder="Новый номер телефона" required>
                </div>
                <div class="form-group-row">
                    <input type="text" placeholder="Новый адрес пользователя" required>
                </div>
                <div class="form-group-row">
                    <input type="password" placeholder="Новый пароль" required>
                </div>
                    <div class="form-group-row">
                    <input type="password" placeholder="Повторите новый пароль" required>
                </div>
                    
                    <button type="submit" class="submit">Сменить данные</button>
                
                </form>
            </div>
        
            <!-- Правая основная часть -->
            <div class="container-row1">
                <h3>История заказов</h3>
                <div class="orders-container" id="orders-container">
                    <!-- Если заказы есть -->
                    <!-- <div class="order">
                        <p><strong>Заказ №12345</strong></p>
                        <p>Дата: 12.03.2023</p>
                        <p>Сумма: 4 500 ₽</p>
                    </div> -->
        
                    <!-- Если заказы недоступны 
                    <div class="container-row">
                        <p>Упс! Здесь пока ничего нет...
                        <img src="images/empty.png" alt="Упс!" style="max-width: 250px; height: auto; opacity: 1; margin: 0 auto;">
                        </p>
                    </div>-->
                </div>
            </div>
        </div>
        


    </main>

<div th:replace="include/footer :: footer"></div>
<script type="module" src="/js/main.js"></script>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const ordersContainer = document.getElementById("orders-container");

            // Проверяем наличие данных о незавершённом заказе в localStorage
            const orderData = JSON.parse(localStorage.getItem("orderData"));

            if (orderData) {
                // Если незавершённый заказ есть, выводим сообщение с кнопками
                const orderMessage = document.createElement("div");
                orderMessage.classList.add("order-message");
                orderMessage.innerHTML = `
                    <p class="text-orders"> ${orderData.name}, ваш заказ не завершён. Хотите продолжить?</p>
                    <div class="button-group">
                        <button class="button-yes" id="continue-order">Да</button>
                        <button class="button-no" id="cancel-order">Нет</button>
                    </div>
                `;

                ordersContainer.appendChild(orderMessage);

                // Обработка кнопки "Да"
                document.getElementById("continue-order").addEventListener("click", function () {
                    window.location.href = "finalOrder.html"; // Перенаправляем на страницу финального заказа
                });

                // Обработка кнопки "Нет"
                document.getElementById("cancel-order").addEventListener("click", function () {
                    // Удаляем данные незавершённого заказа из localStorage
                    localStorage.removeItem("orderData");

                    // Обнуляем корзину (пример: удаляем данные корзины)
                    localStorage.removeItem("cart-items");

                    // Убираем сообщение о незавершённом заказе
                    ordersContainer.innerHTML = `
                        <p>Упс! Здесь пока ничего нет...
                        <img src="images/empty.png" alt="Упс!" style="max-width: 250px; height: auto; opacity: 1; margin: 0 auto;">
                        </p>
                    `;
                });
            } else {
                // Если незавершённый заказ отсутствует, выводим сообщение о пустой истории
                ordersContainer.innerHTML = `
                    <p>Упс! Здесь пока ничего нет...
                    <img src="images/empty.png" alt="Упс!" style="max-width: 250px; height: auto; opacity: 1; margin: 0 auto;">
                    </p>
                `;
            }
        });
    </script>

</body>

</html>